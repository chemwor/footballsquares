<div class="row align-items-center gy-2 mb-4 pb-1 pb-sm-2 pb-lg-3">
  <div class="col-lg-5">
    <h1 class="mb-lg-0">Games Hosting</h1>
  </div>
  <div class="col-xl-2 offset-xl-1 col-lg-3 col-sm-5">
    <select class="form-select" [(ngModel)]="selectedSport" (change)="onSportFilterChange()">
      <option value="">All categories</option>
      @for (sport of sports; track sport.id) {
        <option [value]="sport.name">{{ capitalizeFirstLetter(sport.name) }}</option>
      }
    </select>
  </div>
</div>

@if (loading) {
  <div class="text-center py-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
}

@if (showSignInPrompt) {
  <div class="alert alert-info text-center" role="alert">
    <h5 class="alert-heading">Sign In Required</h5>
    <p class="mb-3">Please sign in to view your hosted games.</p>
    <button type="button" class="btn btn-primary" (click)="navigateToSignIn()">
      <i class="ai-user me-2"></i>Sign In
    </button>
  </div>
} @else if (error) {
  <div class="alert alert-danger" role="alert">
    {{ error }}
  </div>
}

@for (game of paginatedGames; track game.id) {
  <article class="row g-0 border-0 mb-4">
    <a
      class="col-sm-5 col-lg-4 bg-repeat-0 bg-size-cover bg-position-center rounded-5"
      [routerLink]="['/services/admin-game-page', game.id]"
      style="background-image: url({{ game.image }}); min-height: 16rem"
      aria-label="Post image"
    ></a>
    <div class="col-sm-7 col-lg-8">
      <div class="pt-4 pb-sm-4 ps-sm-4 pe-lg-4">
        <h3>
          <a [routerLink]="['/services/admin-game-page', game.id]">{{ game.title }}</a>
        </h3>
        <div class="mb-2">
          <span class="badge bg-primary me-2">{{ capitalizeFirstLetter(game.sport) }}</span>
          <span class="badge bg-secondary me-2">{{ game.match }}</span>
          <span class="badge bg-dark me-2">{{ game.boardSize }}</span>
          <span class="badge bg-success">{{ game.status }}</span>
        </div>
        <p class="d-sm-none d-md-block">{{ game.excerpt }}</p>
        <div class="d-flex flex-wrap align-items-center mt-n2">
          <span class="badge bg-primary me-2">{{ game.ownerName }}</span>
          <span class="fs-xs opacity-20 mt-2 mx-3">|</span>
          <span class="fs-sm text-body-secondary mt-2">{{ game.date }}</span>
        </div>
      </div>
    </div>
  </article>
}

@if (!loading && paginatedGames.length === 0 && !error) {
  <div class="text-center py-5">
    <h4>No games found</h4>
    <p class="text-muted">
      @if (selectedSport) {
        No games found for {{ capitalizeFirstLetter(selectedSport) }}. Try selecting a different category.
      } @else {
        You haven't created any games yet.
      }
    </p>
  </div>
}

@if (!loading && !error && totalItems > 0) {
  <div class="row gy-3 align-items-center mt-lg-5 pt-2 pt-md-4 pt-lg-0">
    <div class="col col-md-6 col-6 order-md-1 order-1">
      <div class="d-flex align-items-center">
        <span class="text-body-secondary fs-sm">Show</span>
        <select class="form-select form-select-flush w-auto" [value]="pageSize" (change)="onPageSizeChange($event)">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="15">15</option>
          <option value="25">25</option>
        </select>
      </div>
    </div>
    <div class="col col-md-6 col-6 order-md-2 order-2">
      <nav aria-label="Page navigation">
        <ngb-pagination
          [(page)]="currentPage"
          [pageSize]="pageSize"
          [collectionSize]="totalItems"
          [maxSize]="5"
          [rotate]="true"
          [boundaryLinks]="true"
          (pageChange)="onPageChange($event)"
          [directionLinks]="false"
          class="pagination pagination-sm justify-content-end"
        >
          <ng-template ngbPaginationPages let-page let-pages="pages">
            @if (page === currentPage) {
              <span class="page-link page-item active" aria-current="page">
                {{page}}<span class="visually-hidden">(current)</span>
              </span>
            } @else {
              <a class="page-link" (click)="onPageChange(page)">{{page}}</a>
            }
          </ng-template>
        </ngb-pagination>
      </nav>
    </div>
  </div>
}
